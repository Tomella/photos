<!DOCTYPE html>
<html>

<head>
    <title>Photos</title>
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="anonymous" />
    <link rel="stylesheet" href="thirdparty/markercluster.css" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
        integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA=="
        crossorigin="anonymous" />
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.css"
        crossorigin="anonymous">
    <link rel="stylesheet" href="app/app.css" />
    <style>
        /* A work around for an annoying little white box on my Google tiles. */
        .leaflet-google-layer img {
            transform: scale(1.005);
        }
    </style>
    <script type="module" src="./components/ph-dialog.js"></script>
    <script type="module" src="./components/ph-thumb-link.js"></script>
    <script type="module" src="./components/ph-messages.js"></script>
</head>

<body>
    <div id="mapId"></div>
    <ph-dialog id="controls"></ph-dialog>
    <ph-messages id="messages" type="info" value="Zoom map to clusters. Click or hover to view image." duration="12">
    </ph-messages>
    <ph-thumb-link id="thumb-link"></ph-thumb-link>
    <ph-menu id="menu"></ph-menu>
    <div class="place-bottom">
        <div id="spinner" style="
            background: #1877F2;
            border-radius: 5px;
            color: white;
            height: 20px;
            text-align: center;
            width: 150px;">
            Loading
        </div>
        <fb:login-button scope="public_profile,email" onlogin="checkLoginState();" data-use-continue-as="true">
        </fb:login-button>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin="anonymous"></script>
    <script src="thirdparty/markercluster.js"></script>
    <script src="lib/latlon.js"></script>
    <script type="module" src="app/app.js"></script>

    <script>
        const authorization = {};

        window.fbAsyncInit = function () {
            FB.init({
                appId: '801539600776006',
                cookie: true,
                xfbml: true,
                version: 'v10.0'
            });

            FB.AppEvents.logPageView();
            console.log("Facebook initted");

            FB.Event.subscribe('xfbml.render', () => {
                console.log("finished rendering plugins");
                var spinner = document.getElementById("spinner");
                spinner.removeAttribute("style");
                spinner.removeChild(spinner.childNodes[0]);
            });

        };

        function checkLoginState() {
            FB.getLoginStatus(function (response) {
                FB.api('/me', function(response) {
                    console.log(response);
                    console.log('Successful login for: ' + response.name);
                    document.getElementById('status').innerHTML =
                    'Thanks for logging in, ' + response.name + '!';
                });
                console.log(response);
            });
        }

        (function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) { return; }
            js = d.createElement(s); js.id = id;
            js.src = "https://connect.facebook.net/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));

    </script>
</body>

</html>
